/**
 * Copyright 2015-2020 | Fabrice Creuzot (luigifab) <code~luigifab~fr>
 * https://www.luigifab.fr/openmage/maillog
 * This program is free software, you can redistribute it or modify
 * it under the terms of the GNU General Public License (GPL).
 */
window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(e,t,n){for(t=t||window,n=0;n<this.length;n++)e.call(t,this[n],n,this)});var maillog=new function(){"use strict";this.template=null,this.nextIdx=0,this.start=function(){var e,t,n,o,l,r;document.getElementById("maillog_sync_bounces_stats_customer")?(console.info("maillog.app - hello"),e=document.getElementById("maillog_sync_bounces_stats_customer"),t=document.getElementById("maillog_sync_bounces_stats_bounce"),n=document.getElementById("maillog_sync_unsubscribers_stats_subscriber"),o=parseInt(e.textContent.trim(),10),l=parseInt(t.textContent.trim(),10),t.textContent+=" ("+Math.floor(100*l/o)+" %)",o=parseInt(e.textContent.trim(),10),l=parseInt(n.textContent.trim(),10),n.textContent+=" ("+Math.floor(100*l/o)+" %)"):document.getElementById("row_maillog_directives_general_special_config")&&(console.info("maillog.app - hello"),r=document.querySelector("tr.template"),this.template=r.innerHTML,this.nextIdx=parseInt(r.getAttribute("data-next"),10),r.parentNode.removeChild(r))},this.add=function(){var e=document.getElementById("maillog_sync_general_mapping_system"),t=document.getElementById("maillog_sync_general_mapping_openmage"),n=document.getElementById("maillog_sync_general_mapping_config");0<e.value.length&&0<t.value.length&&(n.value=(n.value+"\n"+e.value+":"+t.value).trim(),n.scrollTop=n.scrollHeight,e.selectedIndex=0,t.selectedIndex=0,this.mark())},this.mark=function(){var t=document.getElementById("maillog_sync_general_mapping_config").value;document.getElementById("maillog_sync_general_mapping_system").querySelectorAll("option").forEach(function(e){-1<t.indexOf("\n"+e.value+":")||0===t.indexOf(e.value+":")?e.setAttribute("class","has"):e.removeAttribute("class")}),document.getElementById("maillog_sync_general_mapping_openmage").querySelectorAll("option").forEach(function(e){-1<t.indexOf(":"+e.value)?e.setAttribute("class","has"):e.removeAttribute("class")})},this.iframe=function(t){try{t.removeAttribute("onload"),t.contentDocument.querySelector("body").parentNode.innerHTML=decodeURIComponent(escape(self.atob(t.firstChild.nodeValue))),t.style.height=t.contentDocument.querySelector("body").scrollHeight+"px",self.setTimeout(function(){var e=document.querySelector("div.content iframe");e.style.height=e.contentDocument.querySelector("body").scrollHeight+"px"},1e3)}catch(e){t.contentDocument.querySelector("body").textContent=e}},this.resetLifetime=function(e,t){(e=e.parentNode).querySelectorAll("select")[0].selectedIndex=0,e.querySelectorAll("select")[1].selectedIndex=0,e.querySelectorAll("input")[0].value=t.toLowerCase(),e.querySelectorAll("input")[1].value="#000000"},this.removeLifetime=function(e){confirm(Translator.translate("Are you sure?"))&&e.parentNode.parentNode.removeChild(e.parentNode)},this.addPicture=function(e){for(var t=document.createElement("tr"),n=e.parentNode;"TABLE"!==n.nodeName;)n=n.parentNode;n=n.querySelector("tbody"),t.setAttribute("class","added"),t.innerHTML=this.template.replace(/IIDDXX/g,this.nextIdx).replace(/KKEEYY/g,"1"),n.appendChild(t),this.nextIdx+=1},this.deletePicture=function(e){confirm(Translator.translate("Are you sure?"))&&e.parentNode.parentNode.parentNode.removeChild(e.parentNode.parentNode)},this.addBreak=function(e,t){var n=document.createElement("ul"),o=e.parentNode.parentNode.parentNode.querySelector("ul");n.innerHTML=this.template.replace(/IIDDXX/g,t).replace(/KKEEYY/g,o.querySelectorAll("li").length),o.appendChild(n.querySelector("li.breakpoint"))},this.deleteBreak=function(e){confirm(Translator.translate("Are you sure?"))&&e.parentNode.parentNode.parentNode.removeChild(e.parentNode.parentNode)}};"function"==typeof self.addEventListener&&self.addEventListener("load",maillog.start.bind(maillog));